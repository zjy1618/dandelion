<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zjy.dandelion.dao.mapper.OrderDetailMapper">
  <resultMap id="ListMap" type="com.zjy.dandelion.entity.OrderDetail" >

	  <association fetchType="eager" property="productSort" column="productSort_id"
				   select="com.zjy.dandelion.dao.mapper.ProductSortMapper.selectByPrimaryKey" />
   </resultMap>

  <resultMap id="DetailMap" type="com.zjy.dandelion.entity.OrderDetail" extends="ListMap"></resultMap>
  
  <select id="selectByPrimaryKey" resultMap="DetailMap">
  	select * from `order_detail` where id=#{id}
  </select>
  
  <select id="findByMap"  resultMap="ListMap">
  	select * from `order_detail`
  	<where>
  		<if test="orderNumber != null">
  			and orderNumber = #{orderNumber}
  		</if>
		<if test="productCode != null">
			and productCode = #{productCode}
		</if>
  	</where>
  	order by createDate
  </select>
  
  <select id="countByMap" resultType="Integer">
  	select count(id) from `order_detail`
  	<where>
		<if test="orderNumber != null">
			and orderNumber = #{orderNumber}
		</if>
		<if test="productCode != null">
			and productCode = #{productCode}
		</if>
  	</where>
  	order by createDate
  </select>


	<delete id="deleteOrderDetail">
		delete from `order_detail`
		<where>
			<if test="orderNumber != null">
				and orderNumber = #{orderNumber}
			</if>
			<if test="productCode != null">
				and productCode = #{productCode}
			</if>
		</where>
	</delete>

</mapper>
